<!DOCTYPE html>
<html class="fancyScroll">
<head>
  <meta charset="utf-8">
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons" rel="stylesheet">
  <!--<link href="https://cdn.jsdelivr.net/npm/vuetify/dist/vuetify.min.css" rel="stylesheet">-->
  <link href="/css/vuetify.css" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">

  <title>{{ if .Title }}{{ .Title }} {{ else }}{{ .Site.Title }}{{ end }}</title>
  <meta name="description" content="{{ if .Description }}{{ .Description }}{{ else }}{{ .Site.Params.SiteDescription }}{{ end }}">

  <script src="/js/smooth-scroll.js"></script>
  <link href="/css/doc-theme.css?" rel="stylesheet">
  <link rel="icon" href="/favicon.ico">
  <!-- Algolia Docs Search -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
</head>
<body>
</script>
<v-app id="app" class=""  v-cloak style="background-color: white;">
   {{ partial "menu.html" . }}
   {{- partial "toolbar.html" . -}}
   <v-content >
      <v-container class="fluid pa-4" style="padding-top: 0 !important;">
          <v-container class="ma-1 pa-1">
                {{- partial "menu-contextual.html" . -}}
                {{- block "main" . }}{{- end }}
          </v-container>
      </v-container>
    </v-content>
 </v-app>

  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vuetify/1.5.13/vuetify.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue-resource/1.5.1/vue-resource.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
  <script>
    var development = false;
    var app = new Vue({
      el: '#app',
      data: {
        page: 1,
        pageCount: 0,
        error: null,
        results: null,
        drawer: true,
        drawer2: true,
        toc: 0,
        branches: [
        { value: '', text: 'latest'},
        { value: 'dev', text: 'version development'},
          /*{ value: '1.20.2.r0', text: 'version 1.20.2.r0'},
          { value: '1.20.3.b0', text: 'version 1.20.3.b0'},
          { value: '1.20.2.rc10', text: 'version 1.20.2.rc10'},
          { value: '1.20.2.rc9', text: 'version 1.20.2.rc9'},*/
        ],
        branch: ""
      },
      mounted: function () {
        // on boot set default branch as specified as first in array
        this.branch= this.branches[0]
        for (b in this.branches) {
          if ( document.location.href.indexOf(this.branches[b].value) > -1) {
            this.branch= this.branches[b]
          }
        }
        var li = document.links;
        targetVersion = this.branch.value;
        console.log(targetVersion);
        for(var i = 0; i< li.length; i++){
          li[i].href = "/" +targetVersion + li[i].href;
          console.log(li[i].href);
        }

        // there is not always a toc button
        // temp. show page-toc to the user as hint of existence
        if (this.$refs.tocBtn) {
          var elem = this.$refs.tocBtn.$el
          setTimeout(function () {
              elem.click();

          }, 3500);
        }
        var elem2 = document.getElementById("vuetify-theme-stylesheet");
        elem2.parentNode.removeChild(elem2);

      },
      watch: {
        // whenever the branch changes, this function will run
        branch: function (newb, currentb) {
          if (newb.value != this.branches[0].value) {
              var targetVersion = newb;
              var currentVersion = currentb.value;
              if (currentVersion !== targetVersion) {
                console.log("targetversion: ",targetVersion);
                console.log("currentVersion: ", currentVersion);
                var basePath = getPathBeforeVersionName(location, currentVersion);
                console.log("basePath: ",basePath);
                // Getting everything after targetVersion and concatenating it with the hash part.
                var currentPath = getPathAfterVersionName(location, currentVersion);
                console.log("Currentpath:",currentPath);
                var targetPath;
                if (targetVersion === "") {
                  targetPath = basePath + currentPath;
                } else {
                  targetPath = basePath + targetVersion + "/" + currentPath;
                }
                console.log("targetPath:", targetPath);
                //location.assign(targetPath);
              }
          }
        },
      },
    });

    // initialize Algolia doc search
    docsearch({
      apiKey: 'a99fde9999fbec81c1772eb9ffcca488',
      indexName: 'pycom',
      inputSelector: '.algolia-search-field input',
      debug: false // Set debug to true if you want to inspect the dropdown
    });


    function getPathBeforeVersionName(location, versionName) {
      return "/";
    }

    // getPathAfterVersionName gets the current URL path after the version prefix
    function getPathAfterVersionName(location, versionName) {
      let path;
      if (versionName === "") {
        path = location.pathname
          .split("/")
          .slice(1)
          .join("/");
      } else {
        path = location.pathname
          .split("/")
          .slice(2)
          .join("/");
      }

      return path + location.hash;
    }
  </script>
<!--{{- partial "footer.html" . -}}-->
{{- partial "alexia.html" . -}}
{{- partial "google_analitycs.html" . -}}


</body>
</html>
